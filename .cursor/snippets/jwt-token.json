{
  "name": "JWT Token Operations",
  "description": "JWT token creation and validation patterns",
  "prefix": "jwttoken",
  "body": [
    "from datetime import datetime, timedelta",
    "from jose import JWTError, jwt",
    "from app.config import get_settings",
    "from app.core.security import create_access_token, create_refresh_token",
    "from app.models.user import User",
    "from app.models.session import Session",
    "from app.services.session_service import create_user_session",
    "from app.services.user_service import get_user_by_id",
    "from app.core.security import verify_password, get_password_hash",
    "",
    "settings = get_settings()",
    "",
    "# Create tokens",
    "access_token = create_access_token(",
    "    data={\"sub\": str(user.id), \"username\": user.username}",
    ")",
    "refresh_token = create_refresh_token(",
    "    data={\"sub\": str(user.id)}",
    ")",
    "",
    "# Create session",
    "session = await create_user_session(",
    "    db=db,",
    "    user_id=user.id,",
    "    refresh_token=refresh_token,",
    "    ip_address=ip_address,",
    "    user_agent=user_agent,",
    ")"
  ],
  "scope": "python"
} 